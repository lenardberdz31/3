<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-status-bar-style" content="black-translucent">
    <title>CvSU Dashboard</title>
    <style>
        :root { --green: #006400; --gold: #FFD700; --white: #ffffff; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, sans-serif; margin: 0; background: var(--green); overflow: hidden; height: 100vh; }
        
        /* PIN Entry Screen */
        #lock-screen { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s; z-index: 100; position: relative; }
        .logo-container img { width: 160px; height: 160px; transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .logo-container.break img { transform: scale(5) rotate(20deg); opacity: 0; filter: blur(15px); }
        .pin-dots { height: 40px; color: white; font-size: 32px; letter-spacing: 12px; margin: 20px 0; font-weight: bold; }
        .keypad { display: grid; grid-template-columns: repeat(3, 80px); gap: 15px; }
        .key { width: 80px; height: 80px; border: 2px solid var(--gold); border-radius: 50%; color: white; background: none; font-size: 26px; font-weight: bold; }
        .key:active { background: rgba(255, 215, 0, 0.2); }

        /* Dashboard (Main App) */
        #main-app { display: none; background: #f8f9fa; height: 100vh; overflow-y: auto; padding: 20px; padding-top: env(safe-area-inset-top); }
        .header { font-size: 32px; font-weight: 800; color: var(--green); text-align: center; margin: 10px 0; }
        .grad-banner { background: var(--gold); color: var(--green); padding: 15px; border-radius: 15px; text-align: center; font-weight: 800; margin-bottom: 25px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        
        /* Schedule Cards */
        .day-label { font-size: 20px; font-weight: 800; color: var(--green); margin: 25px 0 10px 5px; text-transform: uppercase; border-bottom: 2px solid var(--gold); display: inline-block; }
        .card { 
            background: white; padding: 20px; border-radius: 18px; margin-bottom: 12px; 
            border-left: 10px solid var(--green); position: relative; box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            display: flex; justify-content: space-between; align-items: center;
        }
        .card.faded { opacity: 0.5; filter: grayscale(1); }
        .card-info b { font-size: 18px; display: block; margin-bottom: 4px; color: #2c3e50; }
        .card-info span { color: #7f8c8d; font-weight: 600; font-size: 14px; }
        
        /* Subject View */
        #subject-view { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 2000; padding: 40px 20px; overflow-y: auto; background-size: cover; background-position: center; }
        .overlay { background: rgba(255, 255, 255, 0.92); min-height: 100%; padding: 20px; border-radius: 20px; }
        .tabs { display: flex; background: #f0f0f0; border-radius: 12px; margin: 20px 0; padding: 5px; }
        .tab { flex: 1; padding: 12px; text-align: center; font-weight: bold; border-radius: 10px; }
        .tab.active { background: var(--green); color: white; }
        .tab-content { display: none; padding: 10px 0; }
        .tab-content.active { display: block; }

        /* Utility Buttons */
        .footer-btn { background: var(--green); color: white; width: 100%; padding: 20px; border: none; border-radius: 18px; font-weight: bold; font-size: 16px; margin-top: 15px; }
    </style>
</head>
<body>

    <div id="lock-screen">
        <div class="logo-container" id="logo-box">
            <img src="cvsu-logo.png" alt="CvSU" onerror="this.src='https://upload.wikimedia.org/wikipedia/en/9/9f/Cavite_State_University_%28CvSU%29.png'">
        </div>
        <div class="pin-dots" id="pin-display"></div>
        <div class="keypad">
            <button class="key" onclick="press('1')">1</button><button class="key" onclick="press('2')">2</button><button class="key" onclick="press('3')">3</button>
            <button class="key" onclick="press('4')">4</button><button class="key" onclick="press('5')">5</button><button class="key" onclick="press('6')">6</button>
            <button class="key" onclick="press('7')">7</button><button class="key" onclick="press('8')">8</button><button class="key" onclick="press('9')">9</button>
            <button class="key" style="grid-column: 2" onclick="press('0')">0</button>
        </div>
    </div>

    <div id="main-app">
        <div class="header">Class Schedule</div>
        <div class="grad-banner" id="grad-display" onclick="setGradDate()">Set Graduation Date</div>
        
        <div id="schedule-list">
            <div class="day-label">Wednesday</div>
            <div class="card" id="educ198" onclick="openSubject('EDUC 198 - Appraisal 2', 'educ-bg.jpg')">
                <div class="card-info"><b>EDUC 198- Appraisal 2</b><span>09:00 - 3:00</span></div>
                <input type="checkbox" onclick="event.stopPropagation(); toggleFade('educ198')">
            </div>

            <div class="day-label">Thursday</div>
            <div class="card" id="gned01" onclick="openSubject('GNED 01 - Art App', 'art-bg.jpg')">
                <div class="card-info"><b>GNED 01- Art App</b><span>07:00 - 9:00</span></div>
                <input type="checkbox" onclick="event.stopPropagation(); toggleFade('gned01')">
            </div>
            <div class="card" id="gned10" onclick="openSubject('GNED 10 - Gen and Soc', 'society-bg.jpg')">
                <div class="card-info"><b>GNED 10- Gen and Soc</b><span>09:00 - 11:00</span></div>
                <input type="checkbox" onclick="event.stopPropagation(); toggleFade('gned10')">
            </div>

            <div class="day-label">Friday</div>
            <div class="card" id="gned07" onclick="openSubject('GNED 07 - Contemp', 'world-bg.jpg')">
                <div class="card-info"><b>GNED 07- Contemp</b><span>07:00 - 9:00</span></div>
                <input type="checkbox" onclick="event.stopPropagation(); toggleFade('gned07')">
            </div>
            <div class="card" id="gned13" onclick="openSubject('GNED 13 - Retorika', 'rhetoric-bg.jpg')">
                <div class="card-info"><b>GNED 13- Retorika</b><span>09:00 - 11:00</span></div>
                <input type="checkbox" onclick="event.stopPropagation(); toggleFade('gned13')">
            </div>

            <div class="day-label">Saturday</div>
            <div class="card" id="gned02" onclick="openSubject('GNED 02 - Ethics', 'ethics-bg.jpg')">
                <div class="card-info"><b>GNED 02- Ethics</b><span>07:00 - 9:00</span></div>
                <input type="checkbox" onclick="event.stopPropagation(); toggleFade('gned02')">
            </div>
            <div class="card" id="gned09" onclick="openSubject('GNED 09 - Rizal', 'rizal-bg.jpg')">
                <div class="card-info"><b>GNED 09- Rizal</b><span>09:00 - 11:00</span></div>
                <input type="checkbox" onclick="event.stopPropagation(); toggleFade('gned09')">
            </div>
        </div>
        
        <button class="footer-btn" onclick="handlePortal()">CvSU Student Portal</button>
        <button class="footer-btn" style="background: #333;" onclick="openClearance()">Exit Clearance Checklist</button>
    </div>

    <div id="subject-view">
        <div class="overlay">
            <button style="border:none; background:none; font-size:20px; font-weight:bold; color:var(--green);" onclick="closeSubject()">✕ Close</button>
            <h2 id="subj-name" style="margin:20px 0 5px; color:var(--green); font-size:26px;">Subject</h2>
            
            <div class="tabs">
                <div class="tab active" onclick="switchTab(0)">Checklist</div>
                <div class="tab" onclick="switchTab(1)">Grades</div>
                <div class="tab" onclick="switchTab(2)">History</div>
            </div>

            <div id="tab-0" class="tab-content active">
                <div style="display:flex; gap:10px; margin-bottom:15px;">
                    <input type="text" id="task-in" placeholder="New Task..." style="flex:1; padding:12px; border-radius:10px; border:1px solid #ddd;">
                    <button style="background:var(--green); color:white; border:none; padding:12px; border-radius:10px;" onclick="addTask()">Add</button>
                </div>
                <ul id="task-list" style="padding:0; list-style:none;"></ul>
            </div>

            <div id="tab-1" class="tab-content">
                <h3>Grade Predictor</h3>
                <p>Track your status for this course.</p>
                </div>

            <div id="tab-2" class="tab-content">
                <h3>Weekly History</h3>
                <p>Sunday archive will appear here.</p>
            </div>
        </div>
    </div>

    <script>
        let pin = "";
        const correct = "2113"; // Your Updated PIN

        function press(n) {
            if(pin.length < 4) {
                pin += n;
                document.getElementById('pin-display').innerText = "•".repeat(pin.length);
                if(pin.length === 4) {
                    if(pin === correct) {
                        document.getElementById('logo-box').classList.add('break');
                        if(navigator.vibrate) navigator.vibrate([100, 50, 100]);
                        setTimeout(() => {
                            document.getElementById('lock-screen').style.display = 'none';
                            document.getElementById('main-app').style.display = 'block';
                        }, 600);
                    } else {
                        alert("Incorrect PIN"); pin = ""; document.getElementById('pin-display').innerText = "";
                    }
                }
            }
        }

        function toggleFade(id) { document.getElementById(id).classList.toggle('faded'); } // 50% Fade Logic

        function openSubject(name, bg) {
            document.getElementById('subj-name').innerText = name;
            document.getElementById('subject-view').style.backgroundImage = `url(${bg})`;
            document.getElementById('subject-view').style.display = 'block';
        }

        function closeSubject() { document.getElementById('subject-view').style.display = 'none'; }

        function switchTab(i) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(`tab-${i}`).classList.add('active');
            document.querySelectorAll('.tab')[i].classList.add('active');
        }

        function setGradDate() {
            const d = prompt("Enter Graduation Date (YYYY-MM-DD):");
            if(d) { localStorage.setItem('grad', d); updateGrad(); }
        }

        function updateGrad() {
            const d = localStorage.getItem('grad');
            if(d) {
                const diff = Math.ceil((new Date(d) - new Date()) / (86400000));
                document.getElementById('grad-display').innerText = `Graduation Countdown: ${diff} Days`;
            }
        }

        function handlePortal() {
            let u = localStorage.getItem('pUrl') || prompt("Enter Portal Link:");
            if(u) { localStorage.setItem('pUrl', u); window.open(u, '_blank'); }
        }

        updateGrad();
    </script>
</body>
</html>
